
// Comprehensive Guide to Sharing with Apple Photos
// list sources
// other bugs:
// burst in ios album vs mac album
// Mac siliently failed to share some items (a GIF and a time lapse) for a while.

//   System Version:	macOS 10.13.2 (17C205)
// Photos Version 3.0 (3251.12.190)

// iPhone X: 11.2.2
// iPhone 711.2
// both then: 11.2.5

digraph apple_photos {
	graph [fontname = "helvetica"];
	node [fontname = "helvetica"];
	edge [fontname = "helvetica"];


	#rankdir=LR;
	{
		node [shape=rect, style="rounded", peripheries=2];
		want_to_share [label="I want to share some photos/videos!"];
	}

	{
		node [shape=rect, style="rounded", penwidth=4];
		rank = max;
		rankdir = LR;

		SOL;
		airdrop;
		email;
		imessage;
		icps;
		// export / import (skipping for now, because this is only Mac, and also complicated by original/non wonk. And it's really not a "sharing option")

		/* SOL [label="S.O.L.
			There is no way to do this with Apple Photos."];
		// todo: have notes as to why each of these works given the choices
		airdrop [label="Use AirDrop
			AirDrop preserves ____
			___ note about processing time and related failure ___
			reconverted editted/portriat
			intermitent fail: slo-mo, screenshot lost type tag.
			from-ios-to-ios: slo-mo lost type tag.
			from-Mac-to-mac
			ios note: certain type's metadata lost
			mac note: if photo/live: choose "Photos". if videos, can use finder, and drag into Photos, but certain metadata will be lost
			If you AirDrop to a Mac be sure the recipient chooses to ___ - which is not the default option - otherwise Live Photos, ____ will not send correctly.
			(If you try to AirDrop to your own Mac the photos are automatically sent to the Finder, so Live Photos, ____ will never send correctly.)"];
			todo: test airdrop to own iPhone? (from mac?)
			todo: test airdop from-mac+dnd
		email [label="Send via Email
			todo: check all type imports
			w/ maildrop, w/ actual size
			from-mac: png->jpeg, video downres, heif -> JPEG,
			from-mac: dnd: no video downres, no png->jpeg, DOES heif -> JPEG,
			from-ios: no video downres, no png->jpeg, DOES heif -> JPEG,
			note about actual size, JPEG conversion, lossy special types"];
		imessage [label="Send via iMessage
			ios-to-ios:
				- does lossy to lossy
				- does png to jpeg.
				- slo mo, selfie, and screenshot tagging lost
				- scaled down video
			mac-to-ios:
				- can't choose >1 video
				- same as ios-to-ios
			mac-to-ios: dnd: crashed Photos the first time. second time I had all the images in the message, but it only sent some of them (the others were left in the text feild)
				- same as ios-to-ios
				- added lost types:  live.
			make sure not to MMS???"];
		icps [label="Send via iCloud Photo Sharing
			todo: note about public links, as needed
			steps for limits: https://support.apple.com/en-us/HT202786, https://support.apple.com/en-us/HT202299
			lossy"]; */
	}

	node [shape=diamond];

	want_to_share -> retouch;

	retouch [label="Do you want
		recipients to see
		any retouching you
		do after the
		photos/videos are
		shared?"];
	editable [label="Do you want the
		photos/videos to be
		fully editable (as
		if the recipients
		took them)?"];
	editable_portrait_etc [label="Do you want to share
		'Portrait', 'Burst',
		or 'Slo-mo'
		photos/videos so that
		the recipients can
		edit them?"];
	multiple_photos [label="Do you have
		multiple
		photos to
		share?"];
	want_collection [label="Do you want to share
		a collection of
		photos that you (and
		possibly others) can
		add to over time?"];
	{
		node [label="Do you want to avoid type
			conversion (e.g. recompression
			due to HEIF to JPEG
			conversion) as much as
			possible? (Photos will always
			send certain items like
			editted photos and 'Portrait'
			photos as JPEG.)"]; # todo: note on how to set such up, less quality, larger size. should test editted video
		avoid_convert_type_lossy_to_lossy__icps;
		avoid_convert_type_lossy_to_lossy__email;
		avoid_convert_type_lossy_to_lossy__imessage;
	}
	reordering [label="Do you want to be
		able to reorder the
		photos/videos in the
		shared collection
		after sharing them?"];
	{
		node [label="Do you want to
			avoid downsampling
			(reducing resolution)?"];
		avoid_downres__collection;
		avoid_downres__email_or_icps;
		avoid_downres__video__imessage;
	}
	have_apple__imessage [label="Do the
		recipients have
		iMessage (blue
		bubbles)?"]; // are you sure everyone has an apple device
	video__imessage [label="Are you
		sending a
		video?"];
	{
		node [label="Are the
			recipients in a
			different
			location?"];
		far_away;
		far_away__imessage;
	}
	have_apple__airdrop [label="Do the
		recipients
		have an Apple
		device?"];
	have_live_photo_etc__email [label="Are you
		sharing any
		'Live Photos'?"];
	airdrop__from_ios [label="Are you
		using an iOS
		device?"];
	{
		node [label="Do you want to avoid
			coverting lossless
			images to lossy
			images (e.g. PNG to
			JPEG)?"];
		avoid_convert_type_lossless_to_lossy__airdrop_mac;
		avoid_convert_type_lossless_to_lossy__imessage;
	}
	airdrop_mac_mixed [label="Are you sharing
		both videos and
		'Live Photos'
		the same time?"];

	edge [labeldistance=3];

	retouch -> editable [taillabel="No"];
	retouch -> SOL [taillabel="Yes"];

	editable -> multiple_photos [taillabel="No"];
	editable -> editable_portrait_etc [taillabel="Yes"];

	editable_portrait_etc -> multiple_photos [taillabel="No"];
	editable_portrait_etc -> SOL [taillabel="Yes"];

	multiple_photos -> have_apple__imessage [taillabel="No"];
	multiple_photos -> want_collection [taillabel="Yes"];

	want_collection -> far_away [taillabel="No"];
	want_collection -> avoid_downres__collection [taillabel="Yes"];

	avoid_downres__collection -> reordering [taillabel="No"];
	avoid_downres__collection -> SOL [taillabel="Yes"];

	reordering -> avoid_convert_type_lossy_to_lossy__icps [taillabel="No"];
	reordering -> SOL [taillabel="Yes"];

	have_apple__imessage -> avoid_downres__email_or_icps [taillabel="No"];
	have_apple__imessage -> avoid_convert_type_lossy_to_lossy__imessage [taillabel="Yes"];

	avoid_convert_type_lossy_to_lossy__imessage -> avoid_convert_type_lossless_to_lossy__imessage [taillabel="No"];
	avoid_convert_type_lossy_to_lossy__imessage -> far_away__imessage [taillabel="Yes"];

	avoid_convert_type_lossless_to_lossy__imessage -> video__imessage [taillabel="No"];
	avoid_convert_type_lossless_to_lossy__imessage -> far_away__imessage [taillabel="Yes"];

	far_away__imessage -> airdrop__from_ios [taillabel="No"];
	far_away__imessage -> SOL [taillabel="Yes"];

	video__imessage -> avoid_downres__video__imessage [taillabel="Yes"];
	video__imessage -> imessage [taillabel="No"];

	avoid_downres__video__imessage -> have_live_photo_etc__email [taillabel="Yes"];
	avoid_downres__video__imessage -> imessage [taillabel="No"];

	far_away -> have_apple__airdrop [taillabel="No"];
	far_away -> avoid_downres__email_or_icps [taillabel="Yes"];

	have_apple__airdrop -> avoid_downres__email_or_icps [taillabel="No"];
	have_apple__airdrop -> airdrop__from_ios [taillabel="Yes"];

	airdrop__from_ios -> avoid_convert_type_lossless_to_lossy__airdrop_mac [taillabel="No"];
	airdrop__from_ios -> airdrop [taillabel="Yes"];

	avoid_convert_type_lossless_to_lossy__airdrop_mac -> airdrop_mac_mixed [taillabel="No"];
	avoid_convert_type_lossless_to_lossy__airdrop_mac -> SOL [taillabel="Yes"];

	airdrop_mac_mixed -> airdrop [taillabel="No"];
	airdrop_mac_mixed -> SOL [taillabel="Yes"];

	/* avoid_convert_type_lossy_to_lossy -> avoid_downres__email [taillabel="No"];
	avoid_convert_type_lossy_to_lossy -> SOL [taillabel="Yes"]; */

	avoid_downres__email_or_icps -> avoid_convert_type_lossy_to_lossy__icps [taillabel="No"];
	avoid_downres__email_or_icps -> avoid_convert_type_lossy_to_lossy__email [taillabel="Yes"];

	avoid_convert_type_lossy_to_lossy__icps -> icps [taillabel="No"];
	avoid_convert_type_lossy_to_lossy__icps -> SOL [taillabel="Yes"];

	avoid_convert_type_lossy_to_lossy__email -> have_live_photo_etc__email [taillabel="No"];
	avoid_convert_type_lossy_to_lossy__email -> SOL [taillabel="Yes"];

	have_live_photo_etc__email -> email [taillabel="No"]; // todo: add recipient device check
	have_live_photo_etc__email -> SOL [taillabel="Yes"];

	/* {
		rank=same;
		airdrop_ios_note;
		airdrop_mac_note;
	}

	{
		rank=same;
		avoid_convert_type_lossy_to_lossy__collection;
		far_away;
	}

	{
		rank = same;
		have_apple__airdrop;
		avoid_downres__collection;
	}

	/* {
		rank = same;
		reordering;
		avoid_convert_type_lossy_to_lossy;
	} */

	/*
	{
		rank=same;
		avoid_convert_type_lossless_to_lossy__airdrop_mac;
		avoid_downres__email_or_icps; //far_away;
	}*/

	{
		SOL -> icps -> email -> airdrop -> imessage [ style=invis ];
	}

	/* {
		rank = same;
		have_apple__imessage -> want_collection [ style=invis ];
		rankdir = LR;
	}

	{
		rank = same;
		have_live_photo_etc__email -> icps [ style=invis ];
		rankdir = LR;
	} */




}

// taillabel, headlabel, lp
